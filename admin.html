<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§</title>
<link href="https://fonts.googleapis.com/css2?family=Reem+Kufi+Ink:wght@700&display=swap" rel="stylesheet">
<style>
body {
  font-family: "Reem Kufi Ink", sans-serif;
  background-color: #172630;
  color: #fff;
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 600px;
  margin: auto;
  background-color: #10243b;
  padding: 20px;
  border-radius: 15px;
  border: 2px solid #c8a44d;
}
h2 { text-align: center; color: #c8a44d; }
form { display: flex; flex-direction: column; gap: 12px; margin-top: 20px; }
input { padding: 10px; border-radius: 10px; border: 1px solid #c8a44d; background-color: #172630; color: #fff; font-size: 1rem; text-align: right; }
button { padding: 12px; border-radius: 12px; border: 2px solid rgba(200, 164, 77, 0.7); background: rgba(255, 255, 255, 0.1); color: #c8a44d; font-weight: bold; cursor: pointer; backdrop-filter: blur(8px); transition: all 0.3s ease; }
button:hover { background: rgba(255,255,255,0.2); transform: scale(1.03); }
#message { margin-top: 15px; font-weight: bold; color: #c8a44d; }
</style>
</head>
<body>
<div class="container">
  <h2>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ âš–ï¸</h2>
  
  <form id="adminForm">
    <input type="text" id="fullName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ" required>
    <input type="tel" id="nationalID" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ" required>
    <input type="tel" id="caseNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‚Ø¶ÙŠØ©" required>
    <input type="tel" id="caseYear" placeholder="Ø³Ù†Ø© Ø§Ù„Ù‚Ø¶ÙŠØ©" required>
    <input type="text" id="caseType" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø¶ÙŠØ©" required>
    <input type="text" id="lastAction" placeholder="Ø¢Ø®Ø± Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ…" required>
    <input type="date" id="lastUpdate" placeholder="ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«" required>
    <button type="submit">Ø¥Ø¶Ø§ÙØ© / ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø¶ÙŠØ©</button>
  </form>
  
<div id="message"></div>
<button id="goHomeAdminBtn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ğŸ </button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBjtn7LIv2nIuA18aL8LgzZINKrbDSW0Q0",
  authDomain: "el-mohamady-cases.firebaseapp.com",
  projectId: "el-mohamady-cases",
  storageBucket: "el-mohamady-cases.firebasestorage.app",
  messagingSenderId: "877053136418",
  appId: "1:877053136418:web:9be069bfdbedf70239447b"
};

// ØªÙ‡ÙŠØ¦Ø© Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const form = document.getElementById('adminForm');
const message = document.getElementById('message');

form.addEventListener('submit', async function(e){
  e.preventDefault();

  const fullName = document.getElementById('fullName').value.trim();
  const nationalID = document.getElementById('nationalID').value.trim();
  const caseNumber = document.getElementById('caseNumber').value.trim();
  const caseYear = document.getElementById('caseYear').value.trim();
  const caseType = document.getElementById('caseType').value.trim();
  const lastAction = document.getElementById('lastAction').value.trim();
  const lastUpdate = document.getElementById('lastUpdate').value;

  // Ù†Ø¹Ù…Ù„ Ù…ÙØªØ§Ø­ ÙØ±ÙŠØ¯ Ù„ÙƒÙ„ Ù‚Ø¶ÙŠØ© Ø¹Ù„Ù‰ Ø£Ø³Ø§Ø³ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ + Ø±Ù‚Ù… Ø§Ù„Ù‚Ø¶ÙŠØ© + Ø§Ù„Ø³Ù†Ø©
const caseId = `${nationalID}_${caseNumber}_${caseYear}`;
  const caseRef = doc(db, "cases", caseId);

  try {
    const caseSnap = await getDoc(caseRef);

    await setDoc(caseRef, {
      fullName,
      nationalID,
      caseNumber,
      caseYear,
      caseType,
      lastAction,
      lastUpdate
    });

    if(caseSnap.exists()){
      message.textContent = "âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­";
    } else {
      message.textContent = "âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­";
    }

    form.reset();
  } catch (error) {
    console.error(error);
    message.textContent = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";
  }
});

// Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
document.getElementById('goHomeAdminBtn').addEventListener('click', () => {
  window.location.href = 'index.html';
});
</script>
</body>
</html>
